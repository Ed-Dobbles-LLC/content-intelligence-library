<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Intelligence Briefings ‚Äî Executive Podcast</title>
<meta name="description" content="Executive intelligence briefings on AI, analytics, and enterprise strategy. Produced for senior leaders who think in systems.">
<meta property="og:title" content="Intelligence Briefings">
<meta property="og:description" content="Executive intelligence briefings on AI, analytics, and enterprise strategy.">
<meta property="og:type" content="website">
<link rel="alternate" type="application/rss+xml" title="Intelligence Briefings Podcast" href="/feed.xml">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@400;500;600;700&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
<style>
:root {
  --bg: #0a0d12; --surface: #111620; --surface2: #181f2e;
  --border: rgba(255,255,255,0.07); --red: #c0392b; --red-bright: #e74c3c;
  --white: #eaecf0; --muted: #7c8794; --green: #27ae60; --blue: #2980b9;
  --accent: #e74c3c;
}
* { box-sizing: border-box; margin: 0; padding: 0; }
body { background: var(--bg); color: var(--white); font-family: 'Inter', sans-serif; min-height: 100vh; }

/* HEADER */
header { border-bottom: 1px solid var(--border); padding: 0; }
.header-inner { max-width: 900px; margin: 0 auto; padding: 2rem 1.5rem 1.5rem; }
.show-label { font-family: 'Rajdhani', sans-serif; font-size: 0.72rem; font-weight: 700; letter-spacing: 0.18em; text-transform: uppercase; color: var(--red-bright); margin-bottom: 0.4rem; }
h1 { font-family: 'Rajdhani', sans-serif; font-size: 2.4rem; font-weight: 700; letter-spacing: 0.04em; line-height: 1.1; margin-bottom: 0.6rem; }
h1 span { color: var(--red-bright); }
.show-desc { font-size: 0.9rem; color: var(--muted); line-height: 1.6; max-width: 560px; margin-bottom: 1.2rem; }
.header-actions { display: flex; gap: 0.75rem; flex-wrap: wrap; align-items: center; }
.btn-subscribe { display: inline-flex; align-items: center; gap: 0.4rem; background: var(--red); border: none; border-radius: 4px; color: var(--white); font-family: 'Rajdhani', sans-serif; font-size: 0.8rem; font-weight: 700; letter-spacing: 0.1em; text-transform: uppercase; padding: 9px 18px; cursor: pointer; text-decoration: none; transition: background 0.2s; }
.btn-subscribe:hover { background: #a93226; }
.btn-rss { display: inline-flex; align-items: center; gap: 0.4rem; background: transparent; border: 1px solid var(--border); border-radius: 4px; color: var(--muted); font-family: 'Rajdhani', sans-serif; font-size: 0.8rem; font-weight: 700; letter-spacing: 0.1em; text-transform: uppercase; padding: 9px 18px; cursor: pointer; transition: all 0.2s; }
.btn-rss:hover { border-color: rgba(255,255,255,0.2); color: var(--white); }
.ep-count-label { font-size: 0.75rem; color: var(--muted); }

/* LAYOUT */
.main { max-width: 900px; margin: 0 auto; padding: 1.5rem; }

/* SEARCH / FILTER */
.filter-bar { display: flex; gap: 0.75rem; margin-bottom: 1.5rem; flex-wrap: wrap; }
.search-input { flex: 1; min-width: 200px; background: var(--surface); border: 1px solid var(--border); border-radius: 5px; color: var(--white); font-family: 'Inter', sans-serif; font-size: 0.84rem; padding: 10px 14px; outline: none; transition: border-color 0.2s; }
.search-input:focus { border-color: rgba(231,76,60,0.4); }
.search-input::placeholder { color: var(--muted); }
.filter-btn { background: var(--surface); border: 1px solid var(--border); border-radius: 5px; color: var(--muted); font-family: 'Rajdhani', sans-serif; font-size: 0.75rem; font-weight: 700; letter-spacing: 0.08em; text-transform: uppercase; padding: 10px 14px; cursor: pointer; transition: all 0.2s; white-space: nowrap; }
.filter-btn.active { border-color: var(--red-bright); color: var(--white); background: rgba(231,76,60,0.08); }
.filter-btn:hover:not(.active) { border-color: rgba(255,255,255,0.15); color: var(--white); }

/* NOW PLAYING */
.now-playing { background: var(--surface); border: 1px solid rgba(231,76,60,0.25); border-radius: 8px; padding: 1.25rem; margin-bottom: 1.5rem; display: none; }
.now-playing.visible { display: block; }
.np-label { font-family: 'Rajdhani', sans-serif; font-size: 0.65rem; font-weight: 700; letter-spacing: 0.15em; text-transform: uppercase; color: var(--red-bright); margin-bottom: 0.4rem; display: flex; align-items: center; gap: 0.4rem; }
.np-dot { width: 6px; height: 6px; border-radius: 50%; background: var(--red-bright); animation: pulse 1.5s infinite; }
@keyframes pulse { 0%,100% { opacity:1; } 50% { opacity:0.3; } }
.np-title { font-family: 'Rajdhani', sans-serif; font-size: 1.1rem; font-weight: 700; margin-bottom: 0.5rem; }
.np-desc { font-size: 0.8rem; color: var(--muted); line-height: 1.5; margin-bottom: 0.75rem; max-width: 600px; }
.np-audio audio { width: 100%; }

/* EPISODE LIST */
.ep-list { display: flex; flex-direction: column; gap: 1px; }
.ep-item { background: var(--surface); border-radius: 6px; margin-bottom: 2px; overflow: hidden; transition: background 0.15s; cursor: pointer; }
.ep-item:hover { background: var(--surface2); }
.ep-item.active { background: var(--surface2); border-left: 3px solid var(--red-bright); }
.ep-main { display: flex; align-items: center; gap: 1rem; padding: 1rem 1.25rem; }
.ep-play-btn { width: 36px; height: 36px; border-radius: 50%; background: var(--surface2); border: 1px solid var(--border); display: flex; align-items: center; justify-content: center; flex-shrink: 0; transition: all 0.2s; color: var(--muted); font-size: 0.9rem; }
.ep-item:hover .ep-play-btn, .ep-item.active .ep-play-btn { border-color: var(--red-bright); color: var(--red-bright); background: rgba(231,76,60,0.08); }
.ep-info { flex: 1; min-width: 0; }
.ep-title { font-family: 'Rajdhani', sans-serif; font-size: 0.97rem; font-weight: 700; line-height: 1.3; margin-bottom: 0.2rem; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.ep-meta { display: flex; gap: 0.6rem; align-items: center; flex-wrap: wrap; }
.ep-date { font-size: 0.72rem; color: var(--muted); }
.ep-badge { font-family: 'Rajdhani', sans-serif; font-size: 0.6rem; font-weight: 700; letter-spacing: 0.08em; text-transform: uppercase; background: var(--bg); border: 1px solid var(--border); border-radius: 2px; padding: 1px 5px; color: var(--muted); }
.ep-badge.series { border-color: rgba(41,128,185,0.4); color: var(--blue); }
.ep-expand { flex-shrink: 0; color: var(--muted); font-size: 0.75rem; transition: transform 0.2s; padding: 0 0.25rem; }
.ep-item.expanded .ep-expand { transform: rotate(180deg); }
.ep-detail { display: none; padding: 0 1.25rem 1rem 4.25rem; }
.ep-item.expanded .ep-detail { display: block; }
.ep-desc { font-size: 0.8rem; color: var(--muted); line-height: 1.6; margin-bottom: 0.75rem; }
.ep-inline-audio audio { width: 100%; height: 38px; }
.ep-sources { font-size: 0.68rem; color: var(--muted); font-style: italic; margin-top: 0.4rem; }

/* EMPTY */
.empty-state { text-align: center; padding: 4rem 1rem; color: var(--muted); }
.empty-state h3 { font-family: 'Rajdhani', sans-serif; font-size: 1.1rem; font-weight: 700; margin-bottom: 0.5rem; color: var(--white); }

/* RSS MODAL */
.rss-modal { position: fixed; inset: 0; background: rgba(0,0,0,0.75); z-index: 100; display: none; align-items: center; justify-content: center; }
.rss-modal.open { display: flex; }
.rss-box { background: var(--surface); border: 1px solid var(--border); border-radius: 8px; padding: 1.5rem; width: 480px; max-width: 95vw; }
.rss-box h3 { font-family: 'Rajdhani', sans-serif; font-size: 1.1rem; font-weight: 700; margin-bottom: 0.25rem; }
.rss-box p { font-size: 0.8rem; color: var(--muted); margin-bottom: 1rem; line-height: 1.5; }
.rss-url-display { background: var(--bg); border: 1px solid var(--border); border-radius: 4px; padding: 10px 12px; font-family: monospace; font-size: 0.78rem; color: var(--white); word-break: break-all; margin-bottom: 0.75rem; }
.rss-actions { display: flex; gap: 0.5rem; }
.btn-copy-rss { flex: 1; background: var(--red); border: none; border-radius: 4px; color: var(--white); font-family: 'Rajdhani', sans-serif; font-size: 0.8rem; font-weight: 700; padding: 10px; cursor: pointer; }
.btn-close-rss { flex: 0 0 auto; background: transparent; border: 1px solid var(--border); border-radius: 4px; color: var(--muted); font-family: 'Rajdhani', sans-serif; font-size: 0.8rem; font-weight: 700; padding: 10px 18px; cursor: pointer; }

/* FOOTER */
footer { border-top: 1px solid var(--border); margin-top: 3rem; padding: 1.5rem; text-align: center; color: var(--muted); font-size: 0.75rem; }
footer a { color: var(--muted); text-decoration: none; }
footer a:hover { color: var(--white); }
</style>
</head>
<body>

<div class="rss-modal" id="rssModal">
  <div class="rss-box">
    <h3>Subscribe via Podcast App</h3>
    <p>Copy this RSS feed URL and paste it into Apple Podcasts, Overcast, Pocket Casts, or any podcast app that supports custom RSS feeds.</p>
    <div class="rss-url-display" id="rssUrlDisplay"></div>
    <div class="rss-actions">
      <button class="btn-copy-rss" onclick="copyFeedUrl()">Copy Feed URL</button>
      <button class="btn-close-rss" onclick="closeRSSModal()">Close</button>
    </div>
  </div>
</div>

<header>
  <div class="header-inner">
    <div class="show-label">Executive Intelligence Podcast</div>
    <h1>INTELLIGENCE <span>BRIEFINGS</span></h1>
    <div class="show-desc">Senior-level analysis on AI, analytics, and enterprise strategy. Two experienced practitioners ‚Äî no hype, no basics. Topics calibrated for executives who already know the fundamentals.</div>
    <div class="header-actions">
      <button class="btn-subscribe" onclick="openRSSModal()">
        üéô Subscribe via RSS
      </button>
      <button class="btn-rss" onclick="openApplePodcasts()">Open in Apple Podcasts</button>
      <span class="ep-count-label" id="epCountLabel"></span>
    </div>
  </div>
</header>

<main class="main">

  <!-- NOW PLAYING -->
  <div class="now-playing" id="nowPlaying">
    <div class="np-label"><div class="np-dot"></div> Now Playing</div>
    <div class="np-title" id="npTitle"></div>
    <div class="np-desc" id="npDesc"></div>
    <div class="np-audio"><audio id="mainPlayer" controls style="width:100%"></audio></div>
  </div>

  <!-- FILTERS -->
  <div class="filter-bar">
    <input type="text" class="search-input" id="searchInput" placeholder="Search episodes..." oninput="filterEpisodes()">
    <button class="filter-btn active" onclick="setFilter('all', this)">All</button>
    <button class="filter-btn" onclick="setFilter('series', this)">Series</button>
    <button class="filter-btn" onclick="setFilter('standard', this)">Standalone</button>
  </div>

  <!-- EPISODE LIST -->
  <div class="ep-list" id="epList">
    <div class="empty-state"><h3>Loading episodes...</h3></div>
  </div>

</main>

<footer>
  <p>Intelligence Briefings ¬∑ <a href="/feed.xml">RSS Feed</a> ¬∑ <a href="/">Production Console</a></p>
</footer>

<script>
let allEpisodes = [];
let activeFilter = 'all';
let currentEpId = null;
const BASE_URL = window.location.origin;

async function init() {
  document.getElementById('rssUrlDisplay').textContent = BASE_URL + '/feed.xml';
  try {
    const data = await fetch('/api/episodes').then(r => r.json());
    allEpisodes = (data.episodes || []).filter(e => !e.is_trailer).reverse();
    document.getElementById('epCountLabel').textContent = allEpisodes.length + ' episode' + (allEpisodes.length !== 1 ? 's' : '');
    renderEpisodes();
  } catch(e) {
    document.getElementById('epList').innerHTML = '<div class="empty-state"><h3>Could not load episodes</h3></div>';
  }
}

function setFilter(f, btn) {
  activeFilter = f;
  document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
  renderEpisodes();
}

function filterEpisodes() {
  renderEpisodes();
}

function getFilteredEpisodes() {
  const q = document.getElementById('searchInput').value.toLowerCase().trim();
  return allEpisodes.filter(ep => {
    if (activeFilter === 'series' && !ep.series_id) return false;
    if (activeFilter === 'standard' && ep.series_id) return false;
    if (q && !ep.title.toLowerCase().includes(q) && !(ep.description || '').toLowerCase().includes(q)) return false;
    return true;
  });
}

function renderEpisodes() {
  const eps = getFilteredEpisodes();
  const list = document.getElementById('epList');
  if (!eps.length) {
    list.innerHTML = '<div class="empty-state"><h3>No episodes found</h3><p>Try adjusting your search or filter.</p></div>';
    return;
  }
  list.innerHTML = eps.map(ep => {
    const date = new Date(ep.published).toLocaleDateString('en-US', {month:'long', day:'numeric', year:'numeric'});
    const isActive = ep.id === currentEpId;
    const seriesBadge = ep.series_id ? '<span class="ep-badge series">Series</span>' : '';
    const depthBadge = ep.depth ? `<span class="ep-badge">${ep.depth}</span>` : '';
    const playIcon = isActive ? '‚ñê‚ñê' : '‚ñ∂';
    return `<div class="ep-item${isActive ? ' active' : ''}" id="epitem-${ep.id}">
      <div class="ep-main" onclick="toggleEpisode('${ep.id}')">
        <div class="ep-play-btn" onclick="event.stopPropagation();playEpisode('${ep.id}')">${playIcon}</div>
        <div class="ep-info">
          <div class="ep-title">${ep.title}</div>
          <div class="ep-meta">
            <span class="ep-date">${date}</span>
            ${depthBadge}
            ${seriesBadge}
          </div>
        </div>
        <div class="ep-expand">‚ñæ</div>
      </div>
      <div class="ep-detail">
        ${ep.description ? `<div class="ep-desc">${ep.description}</div>` : ''}
        <div class="ep-inline-audio">
          <audio controls src="/episodes/${ep.file}" style="width:100%;height:38px" onplay="setNowPlaying('${ep.id}')"></audio>
        </div>
        ${ep.sources && ep.sources.length ? `<div class="ep-sources">Sources: ${ep.sources.join(', ')}</div>` : ''}
      </div>
    </div>`;
  }).join('');
}

function toggleEpisode(epId) {
  const el = document.getElementById('epitem-' + epId);
  if (!el) return;
  const isExpanded = el.classList.contains('expanded');
  document.querySelectorAll('.ep-item.expanded').forEach(e => e.classList.remove('expanded'));
  if (!isExpanded) el.classList.add('expanded');
}

function playEpisode(epId) {
  const ep = allEpisodes.find(e => e.id === epId);
  if (!ep) return;
  setNowPlaying(epId);
  const player = document.getElementById('mainPlayer');
  player.src = '/episodes/' + ep.file;
  player.play();
  // Expand the episode row too
  const el = document.getElementById('epitem-' + epId);
  if (el && !el.classList.contains('expanded')) el.classList.add('expanded');
}

function setNowPlaying(epId) {
  const ep = allEpisodes.find(e => e.id === epId);
  if (!ep) return;
  currentEpId = epId;
  document.getElementById('nowPlaying').classList.add('visible');
  document.getElementById('npTitle').textContent = ep.title;
  document.getElementById('npDesc').textContent = ep.description || '';
  // Update active state
  document.querySelectorAll('.ep-item').forEach(el => el.classList.remove('active'));
  const activeEl = document.getElementById('epitem-' + epId);
  if (activeEl) activeEl.classList.add('active');
}

function openRSSModal() { document.getElementById('rssModal').classList.add('open'); }
function closeRSSModal() { document.getElementById('rssModal').classList.remove('open'); }

function copyFeedUrl() {
  navigator.clipboard.writeText(BASE_URL + '/feed.xml');
  const btn = document.querySelector('.btn-copy-rss');
  btn.textContent = '‚úì Copied!';
  setTimeout(() => btn.textContent = 'Copy Feed URL', 2000);
}

function openApplePodcasts() {
  window.open('podcast://' + window.location.host + '/feed.xml', '_blank');
}

init();
</script>
</body>
</html>
